<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic Page Loader</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
        }

        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            font-size: 1.2rem;
            color: #666;
        }

        .error {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            text-align: center;
            color: #e74c3c;
        }

        .error h1 {
            font-size: 2rem;
            margin-bottom: 1rem;
        }

        .error p {
            font-size: 1.1rem;
            margin-bottom: 2rem;
            color: #666;
        }

        .error a {
            color: #3498db;
            text-decoration: none;
            font-weight: bold;
        }

        .error a:hover {
            text-decoration: underline;
        }

        #content {
            width: 100%;
            height: 100vh;
        }

        iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
    </style>
</head>

<body>
    <div id="loading" class="loading">
        Loading page...
    </div>

    <div id="error" class="error" style="display: none;">
        <h1>Page Not Found</h1>
        <p>The requested page could not be loaded.</p>
        <a href="?page=050832323">View Sample Page</a>
    </div>

    <div id="content" style="display: none;"></div>

    <script>
        // Get page parameter from URL
        function getPageParam() {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get('page');
        }

        // Load page content
        async function loadPage(pageId) {
            if (!pageId) {
                showError();
                return;
            }

            try {
                const response = await fetch(`pages/${pageId}.html`);

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const content = await response.text();

                // Hide loading indicator
                document.getElementById('loading').style.display = 'none';

                // Show content container
                const contentDiv = document.getElementById('content');
                contentDiv.style.display = 'block';

                // Create iframe to isolate the loaded page's styles
                const iframe = document.createElement('iframe');
                iframe.srcdoc = content;
                iframe.onload = function () {
                    // Optional: Adjust iframe height based on content
                    try {
                        const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                        const height = iframeDoc.body.scrollHeight;
                        iframe.style.height = height + 'px';
                    } catch (e) {
                        // Cross-origin restrictions might prevent this
                        console.log('Could not adjust iframe height:', e);
                    }
                };

                contentDiv.appendChild(iframe);

                // Update page title if possible
                try {
                    const parser = new DOMParser();
                    const doc = parser.parseFromString(content, 'text/html');
                    const title = doc.querySelector('title');
                    if (title) {
                        document.title = title.textContent;
                    }
                } catch (e) {
                    console.log('Could not extract title:', e);
                }

            } catch (error) {
                console.error('Error loading page:', error);
                showError();
            }
        }

        // Show error message
        function showError() {
            document.getElementById('loading').style.display = 'none';
            document.getElementById('error').style.display = 'flex';
        }

        // Alternative method: Load content directly (without iframe)
        async function loadPageDirect(pageId) {
            if (!pageId) {
                showError();
                return;
            }

            try {
                const response = await fetch(`pages/${pageId}.html`);

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const content = await response.text();

                // Replace entire document content
                document.open();
                document.write(content);
                document.close();

            } catch (error) {
                console.error('Error loading page:', error);
                showError();
            }
        }

        // Initialize page loading
        document.addEventListener('DOMContentLoaded', function () {
            const pageId = getPageParam();

            // Use direct loading method for better integration
            // Comment out the line below and uncomment loadPage(pageId) to use iframe method
            loadPageDirect(pageId);

            // Uncomment for iframe method:
            // loadPage(pageId);
        });

        // Handle browser navigation
        window.addEventListener('popstate', function (event) {
            location.reload();
        });
    </script>
</body>

</html>